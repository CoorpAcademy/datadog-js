!function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.logmatic=b()}(this,function(){function a(a,b){if(a)for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])}function b(){var a=!1,b=1e3,c=3e4,d=0,e=null;this.block=function(){e&&clearTimeout(e),a=!0;var f=b*Math.pow(2,d);d++,f=c>f?f:c,e=setTimeout(this.unblock,f)},this.unblock=function(){a=!1,x(!0)},this.isLocked=function(){return a}}function c(a){a&&(j=a),console&&[{f:"log",l:"info"},{f:"info"},{f:"trace"},{f:"warn"},{f:"error"}].forEach(function(a){var b=a.f,c=a.l||a.f,d=console[b];console[b]=function(){var a=null;j&&(a={},a[j]=c);var b=Array.prototype.slice.call(arguments).map(function(a){return"object"==typeof a?JSON.stringify(a):String(a)}).join(" ");v(b,a),d.apply?d.apply(console,arguments):d(b)}})}function d(a){if(a){var b=window.TraceKit;if(b)b.report.subscribe(function(b){var c={};c[a]=b,j&&(c[j]="error"),v(b.message,c)});else{var c=window.onerror;window.onerror=function(b,d,e,f){var g={};g[a]={mode:"JSException",url:d,line:e,column:f},j&&(g[j]="error"),v(b,g),c&&"function"==typeof c&&c.apply(window,arguments)}}}}var e,f,g,h,i,j="severity",k=500,l=10,m=-1,n=null,o=!1,p=null,q=204800,r=new b,s=function(a){e="https://api.logmatic.io/v1/input/"+a},t=function(a){e=a},u=function(a){a=a||{},null!=a.lingerMs&&(k=a.lingerMs),null!=a.maxPostCount&&(a.maxPostCount<1&&(a.maxPostCount=1),l=a.maxPostCount),null!=a.maxWaitingCount&&(m=a.maxWaitingCount),null!=a.maxContentSize&&(q=a.maxContentSize)},v=function(b,c){if(!e)return void console.error("Please init Logmatic before pushing events");var d={message:b};j&&(d[j]="info"),a(c,d),w(d)},w=function(b){a(f,b),i&&(b[i]=window.location.href),n=n||[],n.push(JSON.stringify(b)),m>=0&&n.length>m&&n.shift(),x(!0)},x=function(a){r.isLocked()||o||p||!n||!n.length||(a&&k>=0?p=setTimeout(y,k):y())},y=function(){for(var a=[],b=0,c=0;c<n.length&&l>c;c++){var d=n.shift();if(b+=d.length,b>q){if(d.length>q)break;n.unshift(d);break}a.push(d)}var f="["+a.join(",")+"]";0==n.length&&(n=null),p=null,o=!0;var i;"undefined"!=typeof XDomainRequest&&(i=new XDomainRequest),i=new XMLHttpRequest,i.open("POST",e,!0),i.constructor===XMLHttpRequest&&(i.setRequestHeader("Content-Type","application/json; charset=UTF-8"),g&&i.setRequestHeader("X-Logmatic-Add-IP",g),h&&i.setRequestHeader("X-Logmatic-Add-UserAgent",h));var j=function(a){200!=a.target.status&&0!=a.target.status&&r.block(),o=!1,x(!1)};i.onerror=j,i.onload=j,i.send(f)},z=function(a){f=a},A=function(a){i=a},B=function(a){g=a},C=function(a){h=a};return{init:s,log:v,forceEndpoint:t,setMetas:z,setSendErrors:d,setSendConsoleErrors:d,setSendConsoleLogs:c,setIPTracking:B,setUserAgentTracking:C,setURLTracking:A,setBulkOptions:u}});
//# sourceMappingURL=logmatic.min.js.map