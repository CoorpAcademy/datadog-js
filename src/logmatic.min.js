!function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.logmatic=b()}(this,function(){function a(a,b){if(a)for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])}function b(a){var b={};b.MODE={IMMEDIATE:0,LINGER:1,ERROR:2};var c=500,d=3e4,e=!1,f=null,g=b.MODE.LINGER,h=0,i=a;return b.flush=function(){e=!1},b.isScheduled=function(){return e},b.setMode=function(a){g=a,g!==b.MODE.ERROR&&(h=0)},b.postpone=function(a){var j;switch(f&&clearTimeout(f),e=!0,g){case b.MODE.IMMEDIATE:j=0;break;case b.MODE.LINGER:j=i;break;case b.MODE.ERROR:var k=c*Math.pow(2,h);h++,j=Math.min(k,d)}f=setTimeout(a,j),console.debug("Defer in "+j)},b}function c(a){a&&(j=a),console&&[{f:"log",l:"info"},{f:"info"},{f:"trace"},{f:"warn"},{f:"error"}].forEach(function(a){var b=a.f,c=a.l||a.f,d=console[b];console[b]=function(){var a=null;j&&(a={},a[j]=c);var b=Array.prototype.slice.call(arguments).map(function(a){return"object"==typeof a?JSON.stringify(a):String(a)}).join(" ");u(b,a),d.apply?d.apply(console,arguments):d(b)}})}function d(a){if(a){var b=window.TraceKit;if(b)b.report.subscribe(function(b){var c={};c[a]=b,j&&(c[j]="error"),u(b.message,c)});else{var c=window.onerror;window.onerror=function(b,d,e,f){var g={};g[a]={mode:"JSException",url:d,line:e,column:f},j&&(g[j]="error"),u(b,g),c&&"function"==typeof c&&c.apply(window,arguments)}}}}var e,f,g,h,i="https://api.logmatic.io/v1/input/",j="severity",k=500,l=10,m=-1,n=[],o=!1,p=204800,q=b(k),r=function(a){i+=a},s=function(a){i=a},t=function(a){a=a||{},null!=a.lingerMs&&a.lingerMs>=0&&(k=a.lingerMs),null!=a.maxPostCount&&(a.maxPostCount<1&&(a.maxPostCount=1),l=a.maxPostCount),null!=a.maxWaitingCount&&(m=a.maxWaitingCount),null!=a.maxContentSize&&(p=a.maxContentSize)},u=function(b,c){if(i){var d={message:b};j&&(d[j]="info"),a(c,d),v(d)}},v=function(b){a(e,b),h&&(b[h]=window.location.href),n=n||[],n.push(JSON.stringify(b)),m>=0&&n.length>m&&n.shift(),w()},w=function(){return q.isScheduled()||o?void console.debug("Scheduled"):void q.postpone(x)},x=function(){function a(a){var b=a.target.status;200===b||0===b?n.length>0?q.setMode(q.MODE.IMMEDIATE):q.setMode(q.MODE.LINGER):q.setMode(q.MODE.ERROR),o=!1,q.flush(),w()}o=!0;for(var b=[],c=0;n.length>0&&b.length<l;){var d=n.shift();if(c+=d.length,c>p){if(d.length>p)break;n.unshift(d);break}b.push(d)}if(0===b.length)return o=!1,void q.flush();var e,h="["+b.join(",")+"]";e="undefined"!=typeof XDomainRequest?new XDomainRequest:new XMLHttpRequest,e.open("POST",i,!0),e.constructor===XMLHttpRequest&&(e.setRequestHeader("Content-Type","application/json; charset=UTF-8"),f&&e.setRequestHeader("X-Logmatic-Add-IP",f),g&&e.setRequestHeader("X-Logmatic-Add-UserAgent",g)),e.onerror=a,e.onload=a,e.send(h)},y=function(a){e=a},z=function(a){h=a},A=function(a){f=a},B=function(a){g=a};return{init:r,log:u,forceEndpoint:s,setMetas:y,setSendErrors:d,setSendConsoleErrors:d,setSendConsoleLogs:c,setIPTracking:A,setUserAgentTracking:B,setURLTracking:z,setBulkOptions:t}});
//# sourceMappingURL=logmatic.min.js.map