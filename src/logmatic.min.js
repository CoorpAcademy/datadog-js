!function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.logmatic=b()}(this,function(){function a(a,b){if(a)for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])}function b(a){var b={};b.MODE={IMMEDIATE:0,LINGER:1,ERROR:2};var c=500,d=3e4,e=null,f=b.MODE.LINGER,g=0,h=a;return b.reset=function(){b.isScheduled()&&clearTimeout(e),e=null},b.isScheduled=function(){return null!==e},b.setMode=function(a){f=a,f!==b.MODE.ERROR&&(g=0)},b.postpone=function(a){var i;switch(b.reset(),f){case b.MODE.IMMEDIATE:i=0;break;case b.MODE.LINGER:i=h;break;case b.MODE.ERROR:var j=c*Math.pow(2,g);g++,i=Math.min(j,d)}e=setTimeout(a,i)},b}function c(a){a&&(k=a),console&&[{f:"log",l:"info"},{f:"info"},{f:"trace"},{f:"warn"},{f:"error"}].forEach(function(a){var b=a.f,c=a.l||a.f,d=console[b];console[b]=function(){var a=null;k&&(a={},a[k]=c);var b=Array.prototype.slice.call(arguments).map(function(a){return"object"==typeof a?e(a):String(a)}).join(" ");z(b,a),d.apply?d.apply(console,arguments):d(b)}})}function d(a){if(a){var b=window.TraceKit;if(b)b.report.subscribe(function(b){var c={};c[a]=b,k&&(c[k]="error"),z(b.message,c)});else{var c=window.onerror;window.onerror=function(b,d,e,f){var g={};g[a]={mode:"JSException",url:d,line:e,column:f},k&&(g[k]="error"),z(b,g),c&&"function"==typeof c&&c.apply(window,arguments)}}}}function e(a,b,c,d){var e=function(a,b){var c=[],d=[];return null==b&&(b=function(a,b){return c[0]===b?"[Object Parent]":"[Object Parent] "+d.slice(0,c.indexOf(b)).join(".")}),function(e,f){if(c.length>0){var g=c.indexOf(this);~g?c.splice(g+1):c.push(this),~g?d.splice(g,1/0,e):d.push(e),~c.indexOf(f)&&(f=b.call(this,e,f))}else c.push(f);return null==a?f:a.call(this,e,f)}};return JSON.stringify(a,e(b,d),c)}var f,g,h,i,j="https://api.logmatic.io/v1/input/",k="severity",l=500,m=10,n=-1,o=[],p=204800,q=b(l),r=function(a){j+=a},s=function(a){j=a},t=function(a){a=a||{},null!=a.lingerMs&&a.lingerMs>=0&&(l=a.lingerMs),null!=a.maxPostCount&&(a.maxPostCount<1&&(a.maxPostCount=1),m=a.maxPostCount),null!=a.maxWaitingCount&&(n=a.maxWaitingCount),null!=a.maxContentSize&&(p=a.maxContentSize)},u=function(a,b){z(a,b,"trace")},v=function(a,b){z(a,b,"debug")},w=function(a,b){z(a,b,"info")},x=function(a,b){z(a,b,"warn")},y=function(a,b){z(a,b,"error")},z=function(b,c,d){if(j){var e={message:b};d?e[k]=d:e[k]="info",a(c,e),A(e)}},A=function(b){a(f,b),i&&(b[i]=window.location.href),o=o||[],o.push(e(b)),n>=0&&o.length>n&&o.shift(),B()},B=function(){q.isScheduled()||q.postpone(C)},C=function(){function b(a){200===a||0===a?o.length>0?q.setMode(q.MODE.IMMEDIATE):q.setMode(q.MODE.LINGER):q.setMode(q.MODE.ERROR),q.reset(),0!==o.length&&B()}for(var c=[],d=0;o.length>0&&c.length<m;){var k=o.shift();if(d+=k.length,d>p){if(k.length>p){var l={severity:"warn",message:"Message dropped as its size exceeded the hard limit of "+p+" kBytes"};a(f,l),l[i]=window.location.href,k=e(l)}o.unshift(k);break}c.push(k)}if(0===c.length)return void b(0);var n,r="["+c.join(",")+"]";n="undefined"!=typeof XDomainRequest?new XDomainRequest:new XMLHttpRequest,n.open("POST",j,!0),"undefined"==typeof XDomainRequest&&(n.setRequestHeader("Content-Type","application/json; charset=UTF-8"),g&&n.setRequestHeader("X-Logmatic-Add-IP",g),h&&n.setRequestHeader("X-Logmatic-Add-UserAgent",h)),n.onerror=function(a){b(a.target.status)},n.onload=function(a){b(a.target.status)},n.send(r)},D=function(a){f=a},E=function(a,b){f[a]=b},F=function(a){i=a},G=function(a){g=a},H=function(a){h=a};return{init:r,log:w,trace:u,debug:v,info:w,warn:x,error:y,forceEndpoint:s,setMetas:D,addMeta:E,setSendErrors:d,setSendConsoleErrors:d,setSendConsoleLogs:c,setIPTracking:G,setUserAgentTracking:H,setURLTracking:F,setBulkOptions:t}});
//# sourceMappingURL=logmatic.min.js.map