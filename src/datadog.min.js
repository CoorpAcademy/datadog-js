!function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.datadog=b()}(this,function(){function a(a,b){if(a)for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])}function b(a){var b={};b.MODE={IMMEDIATE:0,LINGER:1,ERROR:2};var c=null,d=b.MODE.LINGER,e=0,f=a;return b.reset=function(){b.isScheduled()&&clearTimeout(c),c=null},b.isScheduled=function(){return null!==c},b.setMode=function(a){(d=a)!==b.MODE.ERROR&&(e=0)},b.postpone=function(a){var g;switch(b.reset(),d){case b.MODE.IMMEDIATE:g=0;break;case b.MODE.LINGER:g=f;break;case b.MODE.ERROR:var h=500*Math.pow(2,e);e++,g=Math.min(h,3e4)}c=setTimeout(a,g)},b}function c(a){a&&(l=a),console&&[{f:"log",l:"info"},{f:"info"},{f:"trace"},{f:"warn"},{f:"error"}].forEach(function(a){var b=a.f,c=a.l||a.f,d=console[b];console[b]=function(){var a=null;l&&(a={},a[l]=c);var b=Array.prototype.slice.call(arguments).map(function(a){return"object"==typeof a?JSON.stringify(a):String(a)}).join(" ");A(b,a),d.apply?d.apply(console,arguments):d(b)}})}function d(a){if(a){var b=window.TraceKit;if(b)b.report.subscribe(function(b){var c={};c[a]=b,l&&(c[l]="error"),A(b.message,c)});else{var c=window.onerror;window.onerror=function(b,d,e,f){var g={};g[a]={mode:"JSException",url:d,line:e,column:f},l&&(g[l]="error"),A(b,g),c&&"function"==typeof c&&c.apply(window,arguments)}}}}var e,f,g,h="https://http-intake.logs.datadoghq.com/v1/input/",i="https://http-intake.logs.datadoghq.eu/v1/input/",j=h,k={},l="severity",m=500,n=10,o=-1,p=[],q=204800,r=b(m),s=function(a,b){b?j=i+a:j+=a},t=function(a){j=a},u=function(a){a=a||{},null!=a.lingerMs&&a.lingerMs>=0&&(m=a.lingerMs),null!=a.maxPostCount&&(a.maxPostCount<1&&(a.maxPostCount=1),n=a.maxPostCount),null!=a.maxWaitingCount&&(o=a.maxWaitingCount),null!=a.maxContentSize&&(q=a.maxContentSize)},v=function(a,b){A(a,b,"trace")},w=function(a,b){A(a,b,"debug")},x=function(a,b){A(a,b,"info")},y=function(a,b){A(a,b,"warn")},z=function(a,b){A(a,b,"error")},A=function(b,c,d){if(j){var e={message:b};e[l]=d||"info",a(c,e),B(e)}},B=function(b){a(k,b),g&&(b[g]=window.location.href),p=p||[],p.push(JSON.stringify(b)),o>=0&&p.length>o&&p.shift(),C()},C=function(){r.isScheduled()||r.postpone(D)},D=function(){function b(a){200===a||0===a?p.length>0?r.setMode(r.MODE.IMMEDIATE):r.setMode(r.MODE.LINGER):r.setMode(r.MODE.ERROR),r.reset(),0!==p.length&&C()}for(var c=[],d=0;p.length>0&&c.length<n;){var h=p.shift();if((d+=h.length)>q){if(h.length>q){var i={severity:"warn",message:"Message dropped as its size exceeded the hard limit of 200 kBytes"};a(k,i),JSON.stringify(i).length>q&&(i={severity:"error",message:"Message dropped because the context size provided exceeded the hard limit of 200 kBytes"}),i[g]=window.location.href,h=JSON.stringify(i)}p.unshift(h);break}c.push(h)}if(0===c.length)return void b(0);var l,m="["+c.join(",")+"]";l="undefined"!=typeof XDomainRequest?new XDomainRequest:new XMLHttpRequest,l.open("POST",j,!0),"undefined"==typeof XDomainRequest&&(l.setRequestHeader("Content-Type","application/json; charset=UTF-8"),e&&l.setRequestHeader("X-Logmatic-Add-IP",e),f&&l.setRequestHeader("X-Logmatic-Add-UserAgent",f)),l.onerror=function(a){b(a.target.status)},l.onload=function(a){b(a.target.status)},l.send(m)},E=function(a){k=a},F=function(a,b){k[a]=b},G=function(a){g=a};return{init:s,log:x,trace:v,debug:w,info:x,warn:y,error:z,forceEndpoint:t,setMetas:E,addMeta:F,setSendErrors:d,setSendConsoleErrors:d,setSendConsoleLogs:c,setIPTracking:function(a){e=a},setUserAgentTracking:function(a){f=a},setURLTracking:G,setBulkOptions:u}});
//# sourceMappingURL=datadog.min.js.map